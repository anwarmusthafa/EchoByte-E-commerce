{% extends "admin_base.html" %}
{% block content %}
{% if error_message %}
    <div class="alert alert-danger" role="alert">
        {{ error_message }}
    </div>
{% endif %}
{% if success_message %}
    <div class="alert alert-success" role="alert">
        {{ success_message }}
    </div>
{% endif %}
<div class="col-12 grid-margin stretch-card">
    <div class="card">
      <div class="card-body">
        <h4 class="card-title">Edit Product</h4>
        {% if product %}
        <form class="forms-sample" method="post" action="{% url 'edit_product' product.pk %}"  enctype="multipart/form-data">
            {% csrf_token %}
             <div class="form-group">
                      <label for="exampleFormControlSelect1">Brand</label>
                      <select  required name="brand" class="form-control form-control-lg" id="exampleFormControlSelect1">
                        <option value="" disabled selected>Choose...</option>
                        {% for brand in existing_brands %}
            <option  value="{{ brand.id }}">{{ brand.brand }}</option>
        {% endfor %}
    </select>
                    </div>

            <div class="form-group">
                <label for="exampleFormControlSelect1">Category</label>
                <select name="category" required class="form-control form-control-lg" id="exampleFormControlSelect1">
                  <option value="" disabled selected>Choose...</option>  
                  {% for value, display_text in category_choices %}
                    <option value="{{ value }}">{{ display_text }}</option>
                {% endfor %}
                </select>
              </div>

         <div class="form-group">
            <label for="exampleInputEmail3">Title</label>
            <input required name="title" value="{{product.title}}" type="text" class="form-control" id="exampleInputEmail3" placeholder="Title">
          </div>

          <div class="form-group">
            <label for="exampleSelectGender">Processor Brand</label>
            <select required name="processor-brand" class="form-control" id="exampleSelectGender">
                <option value="" disabled {% if not product.processor_brand %}selected{% endif %}>Choose..</option>
                {% for processor_brand in existing_processor_brands %}
                    <option value="{{ processor_brand.id }}" {% if product.processor_brand == processor_brand.id %}selected{% endif %}>
                        {{ processor_brand.processor_brand_name }}
                    </option>
                {% endfor %}
            </select>
        </div>
          <div class="form-group">
            <label for="exampleInputEmail3">Processor</label>
            <input required value="{{product.processor}}" name="processor" type="text" class="form-control" id="exampleInputEmail3" placeholder="Processor">
          </div>
          <div class="form-group">
            <label for="exampleInputEmail3">Display</label>
            <input required value="{{product.display}}" name="display" type="text" class="form-control" id="exampleInputEmail3" placeholder="Display">
          </div>
          <div class="form-group">
            <label for="exampleInputEmail3">Front Camera</label>
            <input name="front-camera" value={{product.front_camera}} type="text" class="form-control" id="exampleInputEmail3" placeholder="Front Camera">
          </div>
          <div class="form-group">
            <label for="exampleInputEmail3">Back Camera</label>
            <input  name="back-camera" value="{{product.back_camera}}" type="text" class="form-control" id="exampleInputEmail3" placeholder="Back Camera">
          </div>
          <div class="form-group">
            <label for="exampleInputEmail3">Priority</label>
            <input  name="priority" value="{{product.priority}}" type="number" class="form-control" id="exampleInputEmail3" placeholder="Priority">
          </div>
          <!-- <div class="form-group">
            <label>File upload</label>
            <input type="file" name="img[]" class="file-upload-default">
            <div class="input-group col-xs-12">
              <input type="text" class="form-control file-upload-info" disabled placeholder="Upload Image">
              <span class="input-group-append">
                <button class="file-upload-browse btn btn-gradient-primary" type="button">Upload</button>
              </span>
            </div>
          </div> -->
          <div class="form-group">
            <label for="exampleInputCity1">Battery</label>
            <input name="battery" type="text" value="{{product.battery_capacity}}" class="form-control" id="exampleInputCity1" placeholder="Battery">
          </div>
          <div class="form-group">
            <label  for="exampleTextarea1">Description</label>
            <textarea value="" required  class="form-control" name="description" placeholder="Description" id="exampleTextarea1" rows="4">{{product.description}}</textarea>
          </div>
          {% if images %}
{% for image in images %}
<div class="form-group">
    <label for="">Image {{image.image_order}}</label>
    <input  name="image-{{image.image_order}}" style="padding: 5px;" type='file' onchange="readURL(this , 'blah{{image.image_order}}');" />
<img  style="max-width: 100px;"id="blah{{image.image_order}}" src="{{image.image.url}}" alt="your image" />
  </div>
  
  {% endfor %}
  {% else %}
  <div class="form-group">
    <label for="">Image 1</label>
    <input  name="image-1" style="padding: 5px;" type='file' onchange="readURL(this , 'blah1');" />
<img  style="max-width: 100px;"id="blah1" src="" alt="your image" />
  </div>
  <div class="form-group">
    <label for="">Image 2 </label>
    <input  name="image-2" style="padding: 5px;" type='file' onchange="readURL(this , 'blah2');" />
<img  style="max-width: 100px;"id="blah2" src="" alt="your image" />
  </div>
 
  <div class="form-group">
    <label for="">Image 3 </label>
    <input  name="image-3" style="padding: 5px;" type='file' onchange="readURL(this , 'blah3');" />
<img  style="max-width: 100px;"id="blah3" src="" alt="your image" />
  </div>
  <div class="form-group">
    <label for="">Image 4 </label>
    <input  name="image-4" style="padding: 5px;" type='file' onchange="readURL(this , 'blah4');" />
<img  style="max-width: 100px;"id="blah4" src="" alt="your image" />
  </div>
  <div class="form-group">
    <label for="">Image 5 </label>
    <input  name="image-5" style="padding: 5px;" type='file' onchange="readURL(this , 'blah5');" />
<img  style="max-width: 100px;"id="blah5" src="" alt="your image" />
  </div>
  
  {% endif %}

          
          
          <button type="submit" class="btn btn-gradient-primary me-2">Submit</button>
          <button class="btn btn-light">Cancel</button>
        </form>
        {% endif %}
      </div>
    </div>
  </div>
  <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
  <script>
      function readURL(input, imageId) {
          if (input.files && input.files[0]) {
              var reader = new FileReader();
  
              reader.onload = function (e) {
                  $('#' + imageId).attr('src', e.target.result);
              };
  
              reader.readAsDataURL(input.files[0]);
          }
      }
  </script>
  {% endblock content %}